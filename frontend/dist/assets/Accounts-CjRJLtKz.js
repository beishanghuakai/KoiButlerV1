import{_ as U}from"./_plugin-vue_export-helper-DRcqrMy4.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                     *//* empty css                 *//* empty css                *//* empty css                 *//* empty css                        */import"./el-tooltip-l0sNRNKZ.js";/* empty css                     *//* empty css                        *//* empty css               *//* empty css                  *//* empty css                  */import{u as j}from"./account-B7d52lTG.js";import{d as F,r as y,o as z,e as G,g as o,w as a,a8 as L,ag as R,ah as H,k as f,l as J,ai as K,T as n,ac as O,f as s,ad as P,t as k,s as r,ae as Q,aj as W,ak as X,q as Y,al as Z,am as ee,an as te,ao as oe,ab as ae,af as ne,ap as le,aq as se,E as ie,m as ce,n as de,x as i,ar as re,j as _}from"./index-Bf3lHhEM.js";const ue={class:"accounts-page"},me={class:"card-header"},_e={class:"actions"},pe={class:"account-cell"},fe={class:"account-info"},ke={class:"nickname"},ve={class:"account-id"},ge=F({__name:"Accounts",setup(ye){const l=j(),m=y(!1),c=y({cookies:"",remark:""}),v=y(!1);z(()=>{l.fetchAccounts()});function V(){c.value={cookies:"",remark:""},m.value=!0}async function A(){if(!c.value.cookies.trim()){i.warning("请输入 Cookie");return}v.value=!0;try{await l.createAccount(c.value.cookies,c.value.remark),i.success("添加成功"),m.value=!1}catch{i.error("添加失败")}finally{v.value=!1}}async function x(u,e){try{await l.toggleAccount(u,!e),i.success(e?"已停止":"已启动")}catch{i.error("操作失败")}}async function w(u){try{await l.refreshAccountInfo(u),i.success("刷新成功")}catch{i.error("刷新失败")}}async function B(u){try{await re.confirm("确定删除此账号？删除后无法恢复","确认删除",{type:"warning"}),await l.deleteAccount(u),i.success("删除成功")}catch(e){e!=="cancel"&&i.error("删除失败")}}return(u,e)=>{const d=Y,T=P,p=O,C=Q,g=X,D=W,I=ae,N=ne,S=L,b=de,E=ce,$=ie,q=R,M=K;return _(),G("div",ue,[o(S,null,{header:a(()=>[s("div",me,[e[6]||(e[6]=s("span",{class:"title"},"账号管理",-1)),s("div",_e,[o(d,{icon:n(le),onClick:n(l).fetchAccounts,loading:n(l).loading},{default:a(()=>[...e[4]||(e[4]=[r(" 刷新 ",-1)])]),_:1},8,["icon","onClick","loading"]),o(d,{type:"primary",icon:n(se),onClick:V},{default:a(()=>[...e[5]||(e[5]=[r(" 添加账号 ",-1)])]),_:1},8,["icon"])])])]),default:a(()=>[H((_(),f(I,{data:n(l).accounts,stripe:""},{default:a(()=>[o(p,{label:"账号","min-width":"200"},{default:a(({row:t})=>[s("div",pe,[o(T,{size:40,src:t.avatar},{default:a(()=>[s("span",null,k((t.nickname||t.id)[0]),1)]),_:2},1032,["src"]),s("div",fe,[s("div",ke,k(t.nickname||"未获取"),1),s("div",ve,k(t.id),1)])])]),_:1}),o(p,{label:"备注",prop:"remark",width:"150"},{default:a(({row:t})=>[r(k(t.remark||"-"),1)]),_:1}),o(p,{label:"状态",width:"100",align:"center"},{default:a(({row:t})=>[t.connected?(_(),f(C,{key:0,type:"success"},{default:a(()=>[...e[7]||(e[7]=[r("运行中",-1)])]),_:1})):(_(),f(C,{key:1,type:"info"},{default:a(()=>[...e[8]||(e[8]=[r("已停止",-1)])]),_:1}))]),_:1}),o(p,{label:"操作",width:"200",align:"center"},{default:a(({row:t})=>[o(D,null,{default:a(()=>[o(g,{content:t.connected?"停止":"启动"},{default:a(()=>[o(d,{icon:t.connected?n(Z):n(ee),onClick:h=>x(t.id,t.connected)},null,8,["icon","onClick"])]),_:2},1032,["content"]),o(g,{content:"刷新信息"},{default:a(()=>[o(d,{icon:n(te),onClick:h=>w(t.id)},null,8,["icon","onClick"])]),_:2},1024),o(g,{content:"删除"},{default:a(()=>[o(d,{icon:n(oe),type:"danger",onClick:h=>B(t.id)},null,8,["icon","onClick"])]),_:2},1024)]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[M,n(l).loading]]),!n(l).loading&&n(l).accounts.length===0?(_(),f(N,{key:0,description:"暂无账号"})):J("",!0)]),_:1}),o(q,{modelValue:m.value,"onUpdate:modelValue":e[3]||(e[3]=t=>m.value=t),title:"添加账号",width:"600px"},{footer:a(()=>[o(d,{onClick:e[2]||(e[2]=t=>m.value=!1)},{default:a(()=>[...e[10]||(e[10]=[r("取消",-1)])]),_:1}),o(d,{type:"primary",onClick:A,loading:v.value},{default:a(()=>[...e[11]||(e[11]=[r(" 确定 ",-1)])]),_:1},8,["loading"])]),default:a(()=>[o($,{"label-position":"top"},{default:a(()=>[o(E,{label:"Cookie",required:""},{default:a(()=>[o(b,{modelValue:c.value.cookies,"onUpdate:modelValue":e[0]||(e[0]=t=>c.value.cookies=t),type:"textarea",rows:8,placeholder:"请粘贴闲鱼账号的 Cookie"},null,8,["modelValue"]),e[9]||(e[9]=s("div",{class:"form-tip"}," 从浏览器开发者工具中复制 Cookie，需包含 unb、_m_h5_tk 等关键字段 ",-1))]),_:1}),o(E,{label:"备注"},{default:a(()=>[o(b,{modelValue:c.value.remark,"onUpdate:modelValue":e[1]||(e[1]=t=>c.value.remark=t),placeholder:"可选，用于区分不同账号"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),Ue=U(ge,[["__scopeId","data-v-84a0c2c4"]]);export{Ue as default};
