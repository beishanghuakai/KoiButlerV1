import{_ as S}from"./_plugin-vue_export-helper-DRcqrMy4.js";/* empty css                     *//* empty css                  *//* empty css                 */import{d as L,u as M,r as f,a as q,c as z,o as K,b as N,e as g,f as i,g as o,w as t,h as R,E as U,i as I,j as u,k as A,l as V,m as F,n as j,p as b,q as D,s as d,t as T,v as G,x as E}from"./index-Bf3lHhEM.js";const H={class:"login-container"},J={class:"login-card"},O={key:1,class:"switch-mode"},Q={key:0},W={key:1},X=L({__name:"Login",setup(Y){const h=I(),v=M(),m=f(),w=f(!1),a=f(!1),_=f(!0),s=q({username:"",password:"",confirmPassword:""}),x=(r,e,l)=>{a.value&&e!==s.password?l(new Error("ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´")):l()},C=z(()=>({username:[{required:!0,message:"è¯·è¾“å…¥ç”¨æˆ·å",trigger:"blur"}],password:[{required:!0,message:"è¯·è¾“å…¥å¯†ç ",trigger:"blur"},...a.value?[{min:6,message:"å¯†ç è‡³å°‘6ä½",trigger:"blur"}]:[]],confirmPassword:a.value?[{required:!0,message:"è¯·ç¡®è®¤å¯†ç ",trigger:"blur"},{validator:x,trigger:"blur"}]:[]}));function y(){var r;a.value=!a.value,s.confirmPassword="",(r=m.value)==null||r.clearValidate()}async function p(){m.value&&await m.value.validate(async r=>{if(!r)return;w.value=!0;let e;a.value?(e=await v.register({username:s.username,password:s.password}),e.success&&E.success("æ³¨å†ŒæˆåŠŸ")):(e=await v.login({username:s.username,password:s.password}),e.success&&E.success("ç™»å½•æˆåŠŸ")),w.value=!1,e.success&&h.push("/")})}return K(async()=>{try{const r=await N.registrationStatus();_.value=r.enabled}catch{_.value=!1}}),(r,e)=>{const l=j,c=F,P=D,k=G,B=U;return u(),g("div",H,[i("div",J,[e[7]||(e[7]=i("div",{class:"login-header"},[i("div",{class:"logo-icon"},"ğŸŸ"),i("h1",null,"Koi Butler"),i("p",null,"é—²é±¼è‡ªåŠ¨åŒ–ç®¡ç†ç³»ç»Ÿ")],-1)),o(B,{ref_key:"formRef",ref:m,model:s,rules:C.value,class:"login-form",onSubmit:R(p,["prevent"])},{default:t(()=>[o(c,{prop:"username"},{default:t(()=>[o(l,{modelValue:s.username,"onUpdate:modelValue":e[0]||(e[0]=n=>s.username=n),placeholder:"ç”¨æˆ·å","prefix-icon":"User",size:"large"},null,8,["modelValue"])]),_:1}),o(c,{prop:"password"},{default:t(()=>[o(l,{modelValue:s.password,"onUpdate:modelValue":e[1]||(e[1]=n=>s.password=n),type:"password",placeholder:"å¯†ç ","prefix-icon":"Lock",size:"large","show-password":"",onKeyup:b(p,["enter"])},null,8,["modelValue"])]),_:1}),a.value?(u(),A(c,{key:0,prop:"confirmPassword"},{default:t(()=>[o(l,{modelValue:s.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=n=>s.confirmPassword=n),type:"password",placeholder:"ç¡®è®¤å¯†ç ","prefix-icon":"Lock",size:"large","show-password":"",onKeyup:b(p,["enter"])},null,8,["modelValue"])]),_:1})):V("",!0),o(c,null,{default:t(()=>[o(P,{type:"primary",size:"large",loading:w.value,class:"login-btn",onClick:p},{default:t(()=>[d(T(a.value?"æ³¨å†Œ":"ç™»å½•"),1)]),_:1},8,["loading"])]),_:1}),_.value?(u(),g("div",O,[a.value?(u(),g("span",W,[e[6]||(e[6]=d(" å·²æœ‰è´¦å·ï¼Ÿ ",-1)),o(k,{type:"primary",onClick:y},{default:t(()=>[...e[5]||(e[5]=[d("ç«‹å³ç™»å½•",-1)])]),_:1})])):(u(),g("span",Q,[e[4]||(e[4]=d(" æ²¡æœ‰è´¦å·ï¼Ÿ ",-1)),o(k,{type:"primary",onClick:y},{default:t(()=>[...e[3]||(e[3]=[d("ç«‹å³æ³¨å†Œ",-1)])]),_:1})]))])):V("",!0)]),_:1},8,["model","rules"])])])}}}),ae=S(X,[["__scopeId","data-v-3dff2a20"]]);export{ae as default};
